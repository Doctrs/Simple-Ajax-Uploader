/** Simple Ajax Uploader v2.3 Copyright 2012-2015 LPology, LLC  MIT license https://github.com/LPology/Simple-Ajax-Uploader */
!function(e,t){"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof module&&module.exports?module.exports=t(e):e.ss=t(e)}("undefined"!=typeof window?window:this,function(e){var t,s=e.ss||{},n=/^\s+/,i=/\s+$/,o=/[xy]/g,r=/.*(\/|\\)/,a=/.*[.]/,u=/[\t\r\n]/g,l=Object.prototype.toString.call(e.HTMLElement).indexOf("Constructor")>0,p=-1!==navigator.userAgent.indexOf("MSIE 7"),d=document.createElement("input");d.type="file",t="multiple"in d&&"undefined"!=typeof File&&"undefined"!=typeof(new XMLHttpRequest).upload,s.obj2string=function(e,t){"use strict";var n=[];for(var i in e)if(e.hasOwnProperty(i)){var o=t?t+"["+i+"]":i,r=e[i];n.push("object"==typeof r?s.obj2string(r,o):encodeURIComponent(o)+"="+encodeURIComponent(r))}return n.join("&")},s.extendObj=function(e,t){"use strict";for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])},s.addEvent=function(e,t,n){"use strict";return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n),function(){s.removeEvent(e,t,n)}},s.removeEvent=document.removeEventListener?function(e,t,s){e.removeEventListener&&e.removeEventListener(t,s,!1)}:function(e,t,s){var n="on"+t;"undefined"==typeof e[n]&&(e[n]=null),e.detachEvent(n,s)},s.newXHR=function(){"use strict";if("undefined"!=typeof XMLHttpRequest)return new e.XMLHttpRequest;if(e.ActiveXObject)try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){return!1}},s.encodeUTF8=function(e){"use strict";return unescape(encodeURIComponent(e))},s.getIFrame=function(){"use strict";var e,t=s.getUID();return p?e=document.createElement('<iframe src="javascript:false;" name="'+t+'">'):(e=document.createElement("iframe"),e.src="javascript:false;",e.name=t),e.style.display="none",e.id=t,e},s.getForm=function(e){"use strict";var t=document.createElement("form");t.encoding="multipart/form-data",t.enctype="multipart/form-data",t.style.display="none";for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t},s.getHidden=function(e,t){"use strict";var s=document.createElement("input");return s.type="hidden",s.name=e,s.value=t,s},s.parseJSON=function(t){"use strict";if(!t)return!1;if(t=s.trim(t+""),e.JSON&&e.JSON.parse)try{return e.JSON.parse(t+"")}catch(n){return!1}var i,o=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g,r=null;return t&&!s.trim(t.replace(o,function(e,t,s,n){return i&&t&&(r=0),0===r?e:(i=s||t,r+=!n-!s,"")}))?Function("return "+t)():!1},s.getBox=function(t){"use strict";var s,n,i=0,o=0;if(t.getBoundingClientRect)s=t.getBoundingClientRect(),n=document.documentElement,i=s.top+(e.pageYOffset||n.scrollTop)-(n.clientTop||0),o=s.left+(e.pageXOffset||n.scrollLeft)-(n.clientLeft||0);else do o+=t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return{top:Math.round(i),left:Math.round(o)}},s.addStyles=function(e,t){"use strict";for(var s in t)t.hasOwnProperty(s)&&(e.style[s]=t[s])},s.copyLayout=function(e,t){"use strict";var n=s.getBox(e);s.addStyles(t,{position:"absolute",left:n.left+"px",top:n.top+"px",width:e.offsetWidth+"px",height:e.offsetHeight+"px"})},s.getUID=function(){"use strict";return"axxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,function(e){var t=16*Math.random()|0,s="x"==e?t:3&t|8;return s.toString(16)})};var c="".trim;return s.trim=c&&!c.call("\ufeffÂ ")?function(e){return null===e?"":c.call(e)}:function(e){return e.toString().replace(n,"").replace(i,"")},s.getFilename=function(e){"use strict";return e.replace(r,"")},s.getExt=function(e){"use strict";return-1!==e.indexOf(".")?e.replace(a,""):""},s.hasClass=function(e,t){"use strict";return e&&t?(" "+e.className+" ").replace(u," ").indexOf(" "+t+" ")>=0:!1},s.addClass=function(e,t){"use strict";return e&&t?void(s.hasClass(e,t)||(e.className+=" "+t)):!1},s.removeClass=function(){"use strict";var e={};return function(t,s){return t&&s?(e[s]||(e[s]=new RegExp("(?:^|\\s)"+s+"(?!\\S)")),void(t.className=t.className.replace(e[s],""))):!1}}(),s.purge=function(e){"use strict";var t,n,i,o=e.attributes;if(o)for(t=o.length-1;t>=0;t-=1)i=o[t].name,"function"==typeof e[i]&&(e[i]=null);if(o=e.childNodes)for(n=o.length,t=0;n>t;t+=1)s.purge(e.childNodes[t])},s.remove=function(e){"use strict";e&&e.parentNode&&(s.purge(e),e.parentNode.removeChild(e)),e=null},s.verifyElem=function(t){"use strict";return"undefined"!=typeof jQuery&&t instanceof jQuery?t=t[0]:"string"==typeof t&&("#"==t.charAt(0)&&(t=t.substr(1)),t=document.getElementById(t)),t&&1===t.nodeType?("A"==t.nodeName.toUpperCase()&&(t.style.cursor="pointer",s.addEvent(t,"click",function(t){t&&t.preventDefault?t.preventDefault():e.event&&(e.event.returnValue=!1)})),t):!1},s._options={},s.uploadSetup=function(e){"use strict";s.extendObj(s._options,e)},s.SimpleUpload=function(e){"use strict";var n,i,o;if(this._opts={button:"",url:"",dropzone:"",dragClass:"",cors:!1,withCredentials:!1,progressUrl:!1,sessionProgressUrl:!1,nginxProgressUrl:!1,multiple:!1,maxUploads:3,queue:!0,checkProgressInterval:500,keyParamName:"APC_UPLOAD_PROGRESS",sessionProgressName:"PHP_SESSION_UPLOAD_PROGRESS",nginxProgressHeader:"X-Progress-ID",corsInputName:"XHR_CORS_TARGETORIGIN",allowedExtensions:[],accept:"",maxSize:!1,name:"",data:{},noParams:!1,autoSubmit:!0,multipart:!1,method:"POST",responseType:"",debug:!1,hoverClass:"",focusClass:"",disabledClass:"",customHeaders:{},encodeHeaders:!0,onAbort:function(e,t,s){},onChange:function(e,t,s,n,i){},onSubmit:function(e,t,s,n){},onProgress:function(e){},onUpdateFileSize:function(e){},onComplete:function(e,t,s,n){},onExtError:function(e,t){},onSizeError:function(e,t){},onError:function(e,t,s,n,i,o,r){},startXHR:function(e,t,s){},endXHR:function(e,t,s){},startNonXHR:function(e,t){},endNonXHR:function(e,t){}},s.extendObj(this._opts,s._options),s.extendObj(this._opts,e),e=null,this._btns=[],this._opts.button instanceof Array)for(i=this._opts.button.length,n=0;i>n;n++)o=s.verifyElem(this._opts.button[n]),o!==!1?this._btns.push(this.rerouteClicks(o)):this.log("Button with array index "+n+" is invalid");else o=s.verifyElem(this._opts.button),o!==!1&&this._btns.push(this.rerouteClicks(o));if(delete this._opts.button,this._opts.button=o=null,""===this._opts.dropzone&&(this._btns.length<1||this._btns[0]===!1))throw new Error("Invalid button. Make sure the element you're passing exists.");this._opts.multiple===!1&&(this._opts.maxUploads=1),this._queue=[],this._active=0,this._disabled=!1,this._maxFails=10,this._progKeys={},t||(this._sizeFlags={}),t&&""!==this._opts.dropzone&&(this._dzone=s.verifyElem(this._opts.dropzone),this._dzone?this.addDropZone(this._dzone):this.log("Invalid or nonexistent element passed for drop zone")),this._createInput(),this._manDisabled=!1,this.enable(!0)},s.SimpleUpload.prototype={_killInput:function(){"use strict";this._input&&(this._input.turnOff&&this._input.turnOff(),this._input.focusOff&&this._input.focusOff(),this._input.blurOff&&this._input.blurOff(),this._input.parentNode.mouseOverOff&&this._input.parentNode.mouseOverOff(),s.remove(this._input.parentNode),delete this._input,this._input=null)},destroy:function(){"use strict";for(var e=this._btns.length;e--;)this._btns[e].off&&this._btns[e].off(),s.removeClass(this._btns[e],this._opts.hoverClass),s.removeClass(this._btns[e],this._opts.focusClass),s.removeClass(this._btns[e],this._opts.disabledClass),this._btns[e].disabled=!1;this._killInput(),this._destroy=!0},log:function(t){"use strict";this._opts&&this._opts.debug&&e.console&&e.console.log&&e.console.log("[Uploader] "+t)},setData:function(e){"use strict";this._opts.data=e},setOptions:function(e){"use strict";s.extendObj(this._opts,e)},setProgressBar:function(e){"use strict";this._progBar=s.verifyElem(e)},setPctBox:function(e){"use strict";this._pctBox=s.verifyElem(e)},setFileSizeBox:function(e){"use strict";this._sizeBox=s.verifyElem(e)},setProgressContainer:function(e){"use strict";this._progBox=s.verifyElem(e)},setAbortBtn:function(e,t){"use strict";this._abortBtn=s.verifyElem(e),this._removeAbort=!1,t&&(this._removeAbort=!0)},getQueueSize:function(){"use strict";return this._queue.length},_cycleQueue:function(){"use strict";this._queue.length>0&&this._opts.autoSubmit&&this.submit()},removeCurrent:function(e){"use strict";if(e){for(var t=this._queue.length;t--;)if(this._queue[t].id===e){this._queue.splice(t,1);break}}else this._queue.splice(0,1);this._cycleQueue()},clearQueue:function(){"use strict";this._queue.length=0},disable:function(e){"use strict";var t,n=this._btns.length;for(this._manDisabled=e&&this._manDisabled!==!0?!1:!0,this._disabled=!0;n--;)t=this._btns[n].nodeName.toUpperCase(),("INPUT"==t||"BUTTON"==t)&&(this._btns[n].disabled=!0),""!==this._opts.disabledClass&&s.addClass(this._btns[n],this._opts.disabledClass);this._input&&this._input.parentNode&&(this._input.parentNode.style.visibility="hidden")},enable:function(e){"use strict";if(e||(this._manDisabled=!1),this._manDisabled!==!0){var t=this._btns.length;for(this._disabled=!1;t--;)s.removeClass(this._btns[t],this._opts.disabledClass),this._btns[t].disabled=!1}},updatePosition:function(e){"use strict";e=e?e:this._btns[0],e&&this._input&&this._input.parentNode&&s.copyLayout(e,this._input.parentNode),e=null}},s.IframeUpload={_getHost:function(e){var t=document.createElement("a");return t.href=e,t.hostname?t.hostname.toLowerCase():e},_addFiles:function(e){var t=s.getFilename(e.value),n=s.getExt(t);return!1===this._opts.onChange.call(this,t,n,this._overBtn,void 0,e)?!1:(this._queue.push({id:s.getUID(),file:e,name:t,ext:n,btn:this._overBtn,size:null}),!0)},_uploadIframe:function(t,n,i,o,r,a,u){"use strict";var l,p,d,c,h,f=this,_=this._opts,m=s.getUID(),g=s.getIFrame(),v=!1,b=!1;p=_.noParams===!0?_.url:_.nginxProgressUrl?p+(p.indexOf("?")>-1?"&":"?")+encodeURIComponent(_.nginxProgressHeader)+"="+encodeURIComponent(m):_.url,l=s.getForm({action:p,target:g.name,method:_.method}),_.onProgress.call(this,0),r&&(r.innerHTML="0%"),o&&(o.style.width="0%"),_.cors&&(d=s.addEvent(e,"message",function(e){return f._getHost(e.origin)!=f._getHost(_.url)?void f.log("Non-matching origin: "+e.origin):(v=!0,d(),_.endNonXHR.call(f,t.name,t.btn),void f._finish(t,"","",e.data,i,n,r,a,u))}));var x=s.addEvent(g,"load",function(){x(),_.sessionProgressUrl?l.appendChild(s.getHidden(_.sessionProgressName,m)):_.progressUrl&&l.appendChild(s.getHidden(_.keyParamName,m));for(var p in _.data)_.data.hasOwnProperty(p)&&l.appendChild(s.getHidden(p,_.data[p]));_.cors&&l.appendChild(s.getHidden(_.corsInputName,e.location.href)),l.appendChild(t.file),c=s.addEvent(g,"load",function(){if(g.parentNode&&!b)if(b=!0,delete f._progKeys[m],delete f._sizeFlags[m],c(),a&&s.removeEvent(a,"click",h),_.cors)e.setTimeout(function(){s.remove(l),s.remove(g),v||f._errorFinish(t,"","",!1,"error",n,i,r,a,u),_=m=l=g=i=n=r=a=u=null},600);else{try{var o=g.contentDocument?g.contentDocument:g.contentWindow.document,p=o.body.innerHTML;_.endNonXHR.call(f,t.name,t.btn),f._finish(t,"","",p,i,n,r,a,u)}catch(d){f._errorFinish(t,"",d.message,!1,"error",n,i,r,a,u)}e.setTimeout(function(){s.remove(l),s.remove(g),l=g=null},0),t=_=m=i=n=r=null}}),a&&(h=function(){if(s.removeEvent(a,"click",h),delete f._progKeys[m],delete f._sizeFlags[m],g){b=!0,c();try{g.contentWindow.document.execCommand&&g.contentWindow.document.execCommand("Stop")}catch(o){}try{g.src="javascript".concat(":false;")}catch(o){}e.setTimeout(function(){s.remove(l),s.remove(g),l=g=null},0)}f.log("Upload aborted"),_.onAbort.call(f,t.name,t.btn,t.size),f._last(i,n,r,a,u)},s.addEvent(a,"click",h)),f.log("Commencing upload using iframe"),l.submit(),f._hasProgUrl&&(f._progKeys[m]=1,e.setTimeout(function(){f._getProg(m,o,i,r,1),o=i=r=null},600)),e.setTimeout(function(){f.removeCurrent(t.id)},0)});document.body.appendChild(l),document.body.appendChild(g)},_getProg:function(t,n,i,o,r){"use strict";var a,u,l,p=this,d=this._opts,c=(new Date).getTime();if(t)if(d.nginxProgressUrl?u=d.nginxProgressUrl+"?"+encodeURIComponent(d.nginxProgressHeader)+"="+encodeURIComponent(t)+"&_="+c:d.sessionProgressUrl?u=d.sessionProgressUrl:d.progressUrl&&(u=d.progressUrl+"?progresskey="+encodeURIComponent(t)+"&_="+c),l=function(){var u,c,h,f,_;try{if(l&&(d.cors||4===a.readyState)){l=void 0,a.onreadystatechange=function(){};try{_=a.statusText,f=a.status}catch(m){_="",f=""}if(d.cors||f>=200&&300>f){if(u=s.parseJSON(a.responseText),u===!1)return void p.log("Error parsing progress response (expecting JSON)");if(d.nginxProgressUrl){if("uploading"==u.state)c=parseInt(u.size,10),c>0&&(h=Math.round(parseInt(u.received,10)/c*100),c=Math.round(c/1024));else if("done"==u.state)h=100;else if("error"==u.state)return void p.log("Error requesting upload progress: "+u.status)}else(d.sessionProgressUrl||d.progressUrl)&&u.success===!0&&(c=parseInt(u.size,10),h=parseInt(u.pct,10));if(h&&(o&&(o.innerHTML=h+"%"),n&&(n.style.width=h+"%"),d.onProgress.call(p,h)),c&&!p._sizeFlags[t]&&(i&&(i.innerHTML=c+"K"),p._sizeFlags[t]=1,d.onUpdateFileSize.call(p,c)),!h&&!c&&r>=p._maxFails)return r++,void p.log("Failed progress request limit reached. Count: "+r);100>h&&p._progKeys[t]&&e.setTimeout(function(){p._getProg(t,n,i,o,r),t=n=i=o=r=null},d.checkProgressInterval)}else delete p._progKeys[t],p.log("Error requesting upload progress: "+f+" "+_);a=c=h=f=_=u=null}}catch(m){p.log("Error requesting upload progress: "+m.message)}},d.cors&&!d.sessionProgressUrl){if(!e.XDomainRequest)return;a=new e.XDomainRequest,a.open("GET",u,!0),a.onprogress=a.ontimeout=function(){},a.onload=l,a.onerror=function(){delete p._progKeys[t],t=null,p.log("Error requesting upload progress")}}else{var h,f=d.sessionProgressUrl?"POST":"GET";a=s.newXHR(),a.onreadystatechange=l,a.open(f,u,!0),d.sessionProgressUrl&&(h=encodeURIComponent(d.sessionProgressName)+"="+encodeURIComponent(t),a.setRequestHeader("Content-type","application/x-www-form-urlencoded")),d.nginxProgressUrl&&a.setRequestHeader(d.nginxProgressHeader,t),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),a.send(d.sessionProgressUrl&&h||null)}},_initUpload:function(e){return!1===this._opts.startNonXHR.call(this,e.name,e.btn)?(this._disabled&&this.enable(!0),void this._active--):(this._hasProgUrl=this._opts.progressUrl||this._opts.sessionProgressUrl||this._opts.nginxProgressUrl?!0:!1,this._uploadIframe(e,this._progBox,this._sizeBox,this._progBar,this._pctBox,this._abortBtn,this._removeAbort),void(this._progBox=this._sizeBox=this._progBar=this._pctBox=this._abortBtn=this._removeAbort=null))}},s.XhrUpload={_addFiles:function(e){var t,n,i,o,r=e.length;for(this._opts.multiple||(r=1),o=0;r>o;o++){if(t=s.getFilename(e[o].name),n=s.getExt(t),i=Math.round(e[o].size/1024),!1===this._opts.onChange.call(this,t,n,this._overBtn,i,e[o]))return!1;this._queue.push({id:s.getUID(),file:e[o],name:t,ext:n,btn:this._overBtn,size:i})}return!0},_uploadXhr:function(e,t,n,i,o,r,a,u,l,p){"use strict";var d,c,h=this,f=this._opts,_=s.newXHR();o&&(o.innerHTML=e.size+"K"),u&&(u.innerHTML="0%"),r&&(r.style.width="0%"),d=function(t,n){var i;try{if(d&&(n||4===_.readyState))if(d=void 0,_.onreadystatechange=function(){},n)4!==_.readyState&&_.abort(),f.onAbort.call(h,e.name,e.btn,e.size),h._last(o,a,u,l,p);else{l&&s.removeEvent(l,"click",c);try{i=_.statusText}catch(r){i=""}_.status>=200&&_.status<300?(f.endXHR.call(h,e.name,e.size,e.btn),h._finish(e,_.status,i,_.responseText,o,a,u,l,p)):h._errorFinish(e,_.status,i,_.responseText,"error",a,o,u,l,p)}}catch(r){n||h._errorFinish(e,-1,r.message,!1,"error",a,o,u,l,p)}},l&&(c=function(){s.removeEvent(l,"click",c),d&&d(void 0,!0)},s.addEvent(l,"click",c)),_.onreadystatechange=d,_.open(f.method.toUpperCase(),t,!0),_.withCredentials=!!f.withCredentials,s.extendObj(i,f.customHeaders);for(var m in i)i.hasOwnProperty(m)&&(f.encodeHeaders?_.setRequestHeader(m,s.encodeUTF8(i[m]+"")):_.setRequestHeader(m,i[m]+""));if(s.addEvent(_.upload,"progress",function(e){if(e.lengthComputable){var t=Math.round(e.loaded/e.total*100);f.onProgress.call(h,t),u&&(u.innerHTML=t+"%"),r&&(r.style.width=t+"%")}}),f.onProgress.call(this,0),f.multipart===!0){var g=new FormData;for(var v in n)n.hasOwnProperty(v)&&g.append(v,n[v]);g.append(f.name,e.file),this.log("Commencing upload using multipart form"),_.send(g)}else this.log("Commencing upload using binary stream"),_.send(e.file);this.removeCurrent(e.id)},_initUpload:function(e){"use strict";var t,n={},i={};return!1===this._opts.startXHR.call(this,e.name,e.size,e.btn)?(this._disabled&&this.enable(!0),void this._active--):(n[this._opts.name]=e.name,i["X-Requested-With"]="XMLHttpRequest",i["X-File-Name"]=e.name,"json"==this._opts.responseType.toLowerCase()&&(i.Accept="application/json, text/javascript, */*; q=0.01"),this._opts.multipart||(i["Content-Type"]="application/octet-stream"),s.extendObj(n,this._opts.data),t=this._opts.noParams===!0?this._opts.url:this._opts.url+(this._opts.url.indexOf("?")>-1?"&":"?")+s.obj2string(n),this._uploadXhr(e,t,n,i,this._sizeBox,this._progBar,this._progBox,this._pctBox,this._abortBtn,this._removeAbort),void(this._sizeBox=this._progBar=this._progBox=this._pctBox=this._abortBtn=this._removeAbort=null))}},function(){s.extendObj(s.SimpleUpload.prototype,{_createInput:function(){"use strict";var e=this,n=document.createElement("div");this._input=document.createElement("input"),this._input.type="file",this._input.name=this._opts.name,t&&!l&&this._opts.multiple&&(this._input.multiple=!0),"accept"in this._input&&""!==this._opts.accept&&(this._input.accept=this._opts.accept),s.addStyles(n,{display:"block",position:"absolute",overflow:"hidden",margin:0,padding:0,opacity:0,direction:"ltr",zIndex:16777270}),s.addStyles(this._input,{position:"absolute",right:0,margin:0,padding:0,fontSize:"480px",fontFamily:"sans-serif",cursor:"pointer",height:"100%"}),"0"!==n.style.opacity&&(n.style.filter="alpha(opacity=0)"),this._input.turnOff=s.addEvent(this._input,"change",function(){e._input&&""!==e._input.value&&!1!==e._addFiles(t?e._input.files:e._input)&&(s.removeClass(e._overBtn,e._opts.hoverClass),s.removeClass(e._overBtn,e._opts.focusClass),e._killInput(),e._createInput(),e._opts.autoSubmit&&e.submit())}),""!==e._opts.hoverClass&&(n.mouseOverOff=s.addEvent(n,"mouseover",function(){s.addClass(e._overBtn,e._opts.hoverClass)})),n.mouseOutOff=s.addEvent(n,"mouseout",function(){e._input.parentNode.style.visibility="hidden",""!==e._opts.hoverClass&&(s.removeClass(e._overBtn,e._opts.hoverClass),s.removeClass(e._overBtn,e._opts.focusClass))}),""!==e._opts.focusClass&&(this._input.focusOff=s.addEvent(this._input,"focus",function(){s.addClass(e._overBtn,e._opts.focusClass)}),this._input.blurOff=s.addEvent(this._input,"blur",function(){s.removeClass(e._overBtn,e._opts.focusClass)})),document.body.appendChild(n),n.appendChild(this._input),n=null},rerouteClicks:function(e){"use strict";var t=this;return e.off=s.addEvent(e,"mouseover",function(){t._disabled||(t._input||t._createInput(),t._overBtn=e,s.copyLayout(e,t._input.parentNode),t._input.parentNode.style.visibility="visible")}),e},_last:function(e,t,n,i,o){"use strict";if(e&&(e.innerHTML=""),n&&(n.innerHTML=""),i&&o&&s.remove(i),t&&s.remove(t),this._active--,e=t=n=i=o=null,this._disabled&&this.enable(!0),this._destroy&&0===this._queue.length&&0===this._active.length)for(var r in this)this.hasOwnProperty(r)&&delete this[r];else this._cycleQueue()},_errorFinish:function(e,t,s,n,i,o,r,a,u,l){"use strict";this.log("Upload failed: "+t+" "+s),this._opts.onError.call(this,e.name,i,t,s,n,e.btn,e.size),this._last(r,o,a,u,l),e=t=s=n=i=r=o=a=u=l=null},_finish:function(e,t,n,i,o,r,a,u,l){"use strict";return this.log("Server response: "+i),"json"==this._opts.responseType.toLowerCase()&&(i=s.parseJSON(i),i===!1)?void this._errorFinish(e,t,n,!1,"parseerror",r,o,u,l):(this._opts.onComplete.call(this,e.name,i,e.btn,e.size),this._last(o,r,a,u,l),void(e=t=n=i=o=r=a=u=l=null))},_checkFile:function(e){"use strict";var t=!1,s=this._opts.allowedExtensions.length;if(s>0){for(;s--;)if(this._opts.allowedExtensions[s].toLowerCase()==e.ext.toLowerCase()){t=!0;break}if(!t)return this.removeCurrent(e.id),this.log("File extension not permitted"),this._opts.onExtError.call(this,e.name,e.ext),!1}return e.size&&this._opts.maxSize!==!1&&e.size>this._opts.maxSize?(this.removeCurrent(e.id),this.log(e.name+" exceeds "+this._opts.maxSize+"K limit"),this._opts.onSizeError.call(this,e.name,e.size),!1):(e=null,!0)},submit:function(){"use strict";this._disabled||this._active>=this._opts.maxUploads||this._queue.length<1||this._checkFile(this._queue[0])&&!1!==this._opts.onSubmit.call(this,this._queue[0].name,this._queue[0].ext,this._queue[0].btn,this._queue[0].size)&&(this._active++,(this._opts.multiple===!1||this._opts.queue===!1&&this._active>=this._opts.maxUploads)&&this.disable(!0),this._initUpload(this._queue[0]))}}),t?s.extendObj(s.SimpleUpload.prototype,s.XhrUpload):s.extendObj(s.SimpleUpload.prototype,s.IframeUpload)}(),s.extendObj(s.SimpleUpload.prototype,{_dragFileCheck:function(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return!0;return!1},addDropZone:function(e){var t=this;s.addStyles(e,{zIndex:16777271}),e.ondragenter=function(e){return e.stopPropagation(),e.preventDefault(),t._dragFileCheck(e)?(s.addClass(this,t._opts.dragClass),!1):void 0},e.ondragover=function(e){return e.stopPropagation(),e.preventDefault(),!1},e.ondragend=function(){return s.removeClass(this,t._opts.dragClass),!1},e.ondragleave=function(){return s.removeClass(this,t._opts.dragClass),!1},e.ondrop=function(e){e.stopPropagation(),e.preventDefault(),s.removeClass(this,t._opts.dragClass),t._dragFileCheck(e)&&!1!==t._addFiles(e.dataTransfer.files)&&t._cycleQueue()}}}),s});